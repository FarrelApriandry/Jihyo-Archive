---
// src/pages/vault-dashboard.astro
import Layout from '../layouts/Layout.astro';
import BentoGallery from '../components/react/BentoGallery';
import Navbar from '../components/react/Navbar';
import { supabase } from '../lib/supabase';

// Fetch ONLY premium images
const { data: premiumData } = await supabase
  .from('jihyo_gallery')
  .select('url, caption')
  .eq('is_premium', true);

const images = premiumData?.map(img => img.url) || [];
const captions = premiumData?.map(img => img.caption) || [];
---

<Layout title="The Vault | Restricted Access">
	<Navbar client:load />
	<main class="pt-32 min-h-screen bg-black">
		<div class="max-w-7xl mx-auto px-6 mb-16">
			<div class="border-l border-[#FCC89B] pl-6 py-2">
				<h1 class="text-[10px] tracking-[0.8em] uppercase text-[#FCC89B] mb-2">Access Granted</h1>
				<h2 class="text-4xl font-serif italic text-white">The Premium Archive</h2>
			</div>
		</div>

		{images.length > 0 ? (
			<BentoGallery images={images} caption={captions} client:visible />
		) : (
			<div class="h-[50vh] flex items-center justify-center">
				<p class="text-white/20 tracking-[0.5em] uppercase text-[10px]">
					[ No Premium Data Found in the Vault ]
				</p>
			</div>
		)}

		<div class="py-20 text-center">
			<a href="/" class="text-[10px] tracking-[0.4em] uppercase text-white/30 hover:text-white transition-all">
				‚Üê Back to Public Records
			</a>
		</div>
	</main>
</Layout>